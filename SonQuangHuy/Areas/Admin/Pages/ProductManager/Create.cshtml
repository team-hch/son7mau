@page
@model SonQuangHuy.Admin.ProductManager.CreateModel

@{
    ViewData["Title"] = "Thêm Sản Phẩm";
}
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
   
    <link rel="stylesheet" href="~/lib/jqueryui/themes/base/theme.css" />
    <link rel="stylesheet" href="~/lib/jqueryui/themes/base/jquery-ui.css" />
    <link rel="stylesheet" href="~/lib/elfinder/css/elfinder.full.css" />
    <link rel="stylesheet" href="~/lib/elfinder/css/theme.min.css" />
    <link rel="stylesheet" href="~/css/elfinder-material-theme/Material/css/theme-gray.css" />
    
    <script src="~/lib/jqueryui/jquery-ui.min.js"></script>
    <script src="~/lib/elfinder/js/elfinder.min.js"></script>
    
<h1>Thêm sản phẩm</h1>
<hr />
<div class="row">
    <div class="col-md-12">
        <form method="post" enctype="multipart/form-data">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            @* <input asp-for="Product.Sold" type="number" hidden class="form-control" /> *@
            <div class="form-group">
                <label asp-for="Product.ProductName" class="control-label">Tên nước sơn</label>
                <input asp-for="Product.ProductName" class="form-control" />
                <span asp-validation-for="Product.ProductName" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="UploadAvatar" class="control-label">Ảnh đặt trang chủ</label>
                <input asp-for="UploadAvatar" type="file" class="form-control" />
                <span asp-validation-for="UploadAvatar" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Product.Price" class="control-label">Giá sản phẩm</label>
                <input asp-for="Product.Price" type="number" class="form-control" />
                <span asp-validation-for="Product.Price" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Product.Promotion" class="control-label">Giảm giá (%)</label>
                <input asp-for="Product.Promotion" type="number" class="form-control" value ="0"/>
                <span asp-validation-for="Product.Promotion" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="UploadImage1" class="control-label">Ảnh chi tiết</label>
                <input asp-for="UploadImage1" type="file" class="form-control" />
                <span asp-validation-for="UploadImage1" class="text-danger"></span>
            </div>
            @* <div class="form-group">
                <label asp-for="Product.Quantity" class="control-label">Số lượng</label>
                <input asp-for="Product.Quantity" type="number" class="form-control" />
                <span asp-validation-for="Product.Quantity" class="text-danger"></span>
            </div> *@
            <div class="form-group col-3 d-inline-block" >
                <label asp-for="Product.Weight" class="control-label">Trọng Lượng</label>
                <input asp-for="Product.Weight" type="number" class="form-control" />
                <span asp-validation-for="Product.Weight" class="text-danger"></span>
            @* </div>
            <div class="form-group col-3 d-inline-block">
                <label asp-for="Product.Unit" class="control-label">Đơn vị tính</label>
                <select asp-for="Product.Unit" class ="form-control" asp-items="Model.Units"></select>
                <span asp-validation-for="Product.Unit" class="text-danger"></span>
            </div> *@
            <div class="form-group">
                <label asp-for="Product.ProductType" class="control-label">Loại sơn</label>
                <select asp-for="Product.ProductType" class ="form-control" asp-items="Model.productTypes"></select>
                <span asp-validation-for="Product.ProductType" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Details" class="control-label">Mô tả sản phẩm</label>
                <textarea asp-for="Details" id="details" class="form-control"></textarea>
                <span asp-validation-for="Details" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input type="submit" value="Thêm sản phẩm" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<div>
    <a asp-page="/ProductManager/Index" asp-area="Admin">Quay Lại</a>
</div>
<script>
    editor("details");
    function editor(id){
            (function (factory) {
                if (typeof define === 'function' && define.amd) {
                    define(['jquery'], factory);
                } 
                else if (typeof module === 'object' && module.exports) {
                    module.exports = factory(require('jquery'));
                } else {
                    factory(window.jQuery);
                }
            }(function ($) {
            $.extend($.summernote.plugins, {
                    // Tạo plugin tên elfinder  
                    'elfinder': function (context) {
                        var self = this;
                        // ui has renders to build ui elements.
                        var ui = $.summernote.ui;
                        // Tạo nút bấm
                        context.memo('button.elfinder', function () {
                            var button = ui.button({
                                contents: '<i class="note-icon-picture"/> Chèn ảnh/video',
                                tooltip: 'Chèn ảnh/video',
                                click: function () {
                                    // Bấm vào nút bấm gọi hàm elfinderDialog   
                                    elfinderDialog(context); 
                                }
                            });
                            // create jQuery object from button instance.
                            var $elfinder = button.render();
                            return $elfinder;
                        });
                        // This methods will be called when editor is destroyed by $('..').summernote('destroy');
                        // You should remove elements on `initialize`.
                        this.destroy = function () {
                            this.$panel.remove();
                            this.$panel = null;
                        };
                    }
            
                });
            }));
            function elfinderDialog(editor) {
                var fm = $('<div/>').dialogelfinder({
                baseUrl: "/lib/elfinder/",
                url: "/el-finder-file-system/connector",
                lang : 'vi',
                width : 800,
                height: 450,
                uiOptions: { 
                    toolbar: [
                        @* ['back', 'forward'], *@
                        @* ['reload'], *@
                        @* ['home', 'up'], *@
                        ['upload'],
                        @* ['open', 'download'], *@
                        @* ['undo', 'redo'], *@
                        @* ['info'], *@
                        @* ['quicklook'], *@
                        ['copy', 'cut', 'paste'],
                        @* ['rm'], *@
                        @* ['duplicate', 'rename', 'edit'], *@
                        @* ['selectall', 'selectnone', 'selectinvert'], *@
                        ['sort']
                    ]
                },
                destroyOnClose : true,
                getFileCallback : function(files, fm) {
                    console.log(files);
                    editor.invoke('editor.insertImage', files.url,function ($image) {
                        $image.css('width', '100%');
                        $image.attr('data-filename', 'retriever');
                        })
                    
                },
                commandsOptions : {
                    getfile : {
                        oncomplete : 'close',
                        folders : false
                    }
                }
            }).dialogelfinder('instance');
        }
            $(document).ready(function() {
                    $(`#${id}`).summernote({
                        minHeight: 200,
                        toolbar: [
                        ['style', ['style']],
                        ['font', ['bold', 'underline', 'clear']],
                        ['color', ['color']],
                        ['para', ['ul', 'ol', 'paragraph']],
                        ['table', ['table']],
                        ['insert', ['link','elfinder']],
                        ['view', ['fullscreen', 'codeview', 'help']]
                        ]
                    });
                });
    }
        </script>
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
